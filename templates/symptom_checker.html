{% extends 'base.html' %}
  {% block title %}Symptom Checker - DengueTect{% endblock %}
  {% block content %}
    <a class="btn linkback" href="/dashboard">← Back</a>
    <h2 class="page-title">Symptom Checker</h2>

    <div class="card soft">
      <h3 class="card-title">Are you experiencing these symptoms?</h3>
      <p class="muted">Select all that apply from the past 7 days.</p>
      <form id="symptomForm" action="/risk-assessment" method="get" class="stack">
        <div>
          <p class="strong">Core symptoms</p>
          <div class="chips-grid">
            <label class="chip"><input type="checkbox" name="symptoms" value="fever-high" /><i class="bi bi-thermometer-high"></i><span>High fever (≥38.5°C)</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="severe-headache" /><i class="bi bi-emoji-dizzy"></i><span>Severe headache</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="retro-orbital-pain" /><i class="bi bi-eye"></i><span>Pain behind the eyes</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="myalgia" /><i class="bi bi-activity"></i><span>Muscle pain</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="arthralgia" /><i class="bi bi-activity"></i><span>Joint pain</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="nausea-vomit" /><i class="bi bi-droplet"></i><span>Nausea or vomiting</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="rash" /><i class="bi bi-palette"></i><span>Skin rash</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="fatigue" /><i class="bi bi-emoji-frown"></i><span>Fatigue / weakness</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="loss-appetite" /><i class="bi bi-emoji-neutral"></i><span>Loss of appetite</span></label>
          </div>
        </div>

        <div>
          <p class="strong">Warning signs (seek urgent care)</p>
          <div class="chips-grid">
            <label class="chip"><input type="checkbox" name="symptoms" value="severe-abdominal-pain" /><i class="bi bi-exclamation-octagon"></i><span>Severe abdominal pain</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="persistent-vomiting" /><i class="bi bi-exclamation-octagon"></i><span>Persistent vomiting</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="bleeding-gums-nose" /><i class="bi bi-exclamation-octagon"></i><span>Bleeding gums / nose</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="blood-in-vomit-stool" /><i class="bi bi-exclamation-octagon"></i><span>Blood in vomit or stool</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="lethargy-restlessness" /><i class="bi bi-exclamation-octagon"></i><span>Extreme drowsiness / restlessness</span></label>
            <label class="chip"><input type="checkbox" name="symptoms" value="rapid-breathing" /><i class="bi bi-exclamation-octagon"></i><span>Rapid or difficult breathing</span></label>
          </div>
        </div>

        <div class="row between" style="margin-top:8px">
          <small class="muted">Selected: <span id="selectedCount">0</span></small>
          <button id="submitBtn" class="btn primary" type="submit" disabled>Complete Assessment</button>
        </div>
      </form>
    </div>

    <script>
      (function(){
        const chips = document.querySelectorAll('.chip input[type="checkbox"]');
        const submitBtn = document.getElementById('submitBtn');
        const countEl = document.getElementById('selectedCount');
        function update(){
          let count = 0;
          chips.forEach(cb=>{
            const chip = cb.closest('.chip');
            if (cb.checked){
              chip.classList.add('selected');
              count++;
            } else {
              chip.classList.remove('selected');
            }
          });
          countEl.textContent = count;
          submitBtn.disabled = count === 0;
        }
        chips.forEach(cb=>{
          // Native label->input handles toggling; we only update visuals.
          cb.addEventListener('change', update);
        });
        update();
      })();
    </script>
    {% endblock %}
